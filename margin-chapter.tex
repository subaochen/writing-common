\usepackage[contents={},opacity=1,scale=1,color=white]{background}
\usepackage{tikzpagenodes}
\usepackage{totcount}
\usepackage{shorttoc}
\usetikzlibrary{calc}
\usepackage{assoccnt}

\newif\ifMaterial
\definecolor{light-blue}{rgb}{0.8,0.85,1}

\newlength\LabelSize
\setlength\LabelSize{2.5cm}

% auxiliary counter
\newcounter{chapshift}
\DeclareAssociatedCounters{chapter}{chapshift}

\AtBeginDocument{%
\regtotcounter{chapter}
\setlength\LabelSize{\dimexpr\textheight/\totvalue{chapter}\relax}
\ifdim\LabelSize>2.5cm\relax
  \global\setlength\LabelSize{2.5cm}
\fi
}

\newcommand\AddLabels{%
\Materialtrue%
\AddEverypageHook{%
\ifMaterial%
\ifodd\value{page} %
 \backgroundsetup{
  angle=90,
  position={current page.east|-current page text area.north  east},
  vshift=12pt,
  hshift=-\thechapshift*\LabelSize,
  contents={%
  \tikz\node[fill=light-blue,anchor=west,text width=\LabelSize,
    align=center,text height=15pt,text depth=13pt,font=\large\sffamily] {\thechapter};
  }%
 }
 \else
 \backgroundsetup{
  angle=90,
  position={current page.west|-current page text area.north west},
  vshift=-12pt,
  hshift=-\thechapshift*\LabelSize,
  contents={%
  \tikz\node[fill=light-blue,anchor=west,text width=\LabelSize,
    align=center,text height=15pt,text depth=13pt,font=\large\sffamily] {\rotatebox{180}{\thechapter}};
  }%
 }
 \fi
 \BgMaterial%
\else\relax\fi}%
}

\newcommand\RemoveLabels{\Materialfalse}

